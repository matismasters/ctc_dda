<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Coopera ‚Äî Versi√≥n Completa (V1 + V2)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap 5 CSS (CDN) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { background: #0b1220; color: #e6e8ef; }
    .card { background: #121a2b; border: 1px solid #223150; }
    .brand { letter-spacing: .5px; }
    .resource-value { font-variant-numeric: tabular-nums; }
    .finished {
      background: linear-gradient(135deg, #0a7d40, #0f5132);
      color: #d1f5e1; border: 1px solid #198754;
    }
    .muted { color: #b8bfd3; }
    .badge-soft { background: #1b2742; color: #9fb4ff; }
    .btn-resource { min-width: 140px; }
    .small-note { font-size: .9rem; }
    .resource-counter {
      background: #1b2742;
      border: 1px solid #3d4956;
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
    }
    .resource-current {
      font-size: 2.5rem;
      font-weight: 700;
      color: #ffffff;
      line-height: 1;
      margin-bottom: 0.25rem;
    }
    .resource-total {
      font-size: 1rem;
      color: #9fb4ff;
      font-weight: 500;
    }
    .form-control:focus {
      background: #1b2742 !important;
      border-color: #4dabf7 !important;
      box-shadow: 0 0 0 0.25rem rgba(77, 171, 247, 0.25) !important;
      color: #ffffff !important;
    }
    .is-invalid {
      border-color: #dc3545 !important;
      box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25) !important;
    }
    
    /* Chart.js container */
    .chart-container {
      background: #121a2b;
      border: 1px solid #223150;
      border-radius: 0.5rem;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    /* Minigame specific styles */
    .sequence-number {
      font-size: 4rem;
      font-weight: bold;
      color: #4dabf7;
      text-align: center;
      padding: 2rem;
      background: #1b2742;
      border-radius: 0.5rem;
      margin: 1rem 0;
    }
    
    .math-problem {
      font-size: 1.5rem;
      text-align: center;
      color: #ffffff;
      background: #1b2742;
      padding: 1.5rem;
      border-radius: 0.5rem;
      margin: 1rem 0;
    }
    
    .logic-statement {
      background: #1b2742;
      padding: 1.5rem;
      border-radius: 0.5rem;
      margin: 1rem 0;
    }
    
    .countdown {
      position: absolute;
      top: 15px;
      right: 20px;
      background: rgba(220, 53, 69, 0.2);
      color: #dc3545;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.9rem;
    }
    
    .version-toggle {
      background: #1b2742;
      border: 1px solid #3d4956;
      border-radius: 0.5rem;
      padding: 0.5rem;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-dark border-bottom border-secondary-subtle" style="background:#0b1220;">
    <div class="container">
      <a class="navbar-brand brand d-flex align-items-center gap-2" href="#">
        <span class="fw-bold">Coopera</span>
        <span class="badge rounded-pill text-bg-success" id="versionBadge">V2 (minijuegos + gr√°fico)</span>
      </a>
      <div class="d-flex align-items-center gap-3">
        <span id="playerNameDisplay" class="muted">Jugador: <em>MatiasV</em></span>
        <button id="changeNameBtn" class="btn btn-sm btn-outline-light">Cambiar nombre</button>
      </div>
    </div>
  </nav>

  <!-- Main -->
  <main class="container py-4">

    <!-- Selector de Versi√≥n -->
    <div class="version-toggle d-flex justify-content-center align-items-center gap-3">
      <span class="text-white">Versi√≥n:</span>
      <div class="btn-group" role="group">
        <input type="radio" class="btn-check" name="version" id="v1Radio" autocomplete="off">
        <label class="btn btn-outline-light btn-sm" for="v1Radio">V1 (Botones)</label>
        
        <input type="radio" class="btn-check" name="version" id="v2Radio" autocomplete="off" checked>
        <label class="btn btn-outline-light btn-sm" for="v2Radio">V2 (Minijuegos)</label>
      </div>
    </div>

    <!-- Estado de la partida -->
    <div id="stateBanner" class="alert alert-info border-0" style="display:none;" role="alert">
      <strong>¬°√âxito!</strong> Has recolectado un recurso.
    </div>

    <!-- Chart.js - Solo visible en V2 -->
    <div id="chartContainer" class="chart-container">
      <h4 class="text-white mb-3 text-center">Progreso de Recursos</h4>
      <div style="height: 300px; position: relative;">
        <canvas id="resourceChart"></canvas>
      </div>
      <div class="text-center mt-2">
        <small class="text-muted">Actualizaci√≥n autom√°tica cada 5 segundos</small>
      </div>
    </div>

    <!-- Recursos -->
    <div class="row g-3 mb-3" id="targetsRow">
      <div class="col-12 col-lg-4">
        <div class="card h-100">
          <div class="card-body d-flex flex-column text-center">
            <h5 class="card-title mb-3 text-white">ü™µ Madera</h5>
            
            <div class="resource-counter mb-3">
              <div class="resource-current" id="woodCurrent">7</div>
              <div class="resource-total">de <span id="woodTotal">10</span></div>
            </div>
            
            <p class="card-text muted small-note mb-4" id="woodDescription">
              Resuelve sumas de 3 n√∫meros.
            </p>
            <div class="mt-auto d-grid">
              <button id="btnWood" class="btn btn-primary btn-resource">
                üßÆ Matem√°ticas
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12 col-lg-4">
        <div class="card h-100">
          <div class="card-body d-flex flex-column text-center">
            <h5 class="card-title mb-3 text-white">ü™® Piedra</h5>
            
            <div class="resource-counter mb-3">
              <div class="resource-current" id="stoneCurrent">9</div>
              <div class="resource-total">de <span id="stoneTotal">10</span></div>
            </div>
            
            <p class="card-text muted small-note mb-4" id="stoneDescription">
              Memoriza secuencias de n√∫meros.
            </p>
            <div class="mt-auto d-grid">
              <button id="btnStone" class="btn btn-warning btn-resource">
                üß† Memoria
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12 col-lg-4">
        <div class="card h-100 finished" id="foodCard">
          <div class="card-body d-flex flex-column text-center">
            <h5 class="card-title mb-3">üçé Comida</h5>
            
            <div class="resource-counter mb-3">
              <div class="resource-current" id="foodCurrent">10</div>
              <div class="resource-total">de <span id="foodTotal">10</span></div>
            </div>
            
            <p class="card-text small-note mb-4" id="foodDescription">
              ‚úÖ ¬°Completado!
            </p>
            <div class="mt-auto d-grid">
              <button id="btnFood" class="btn btn-success btn-resource" disabled>
                ‚úÖ Completado
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bot√≥n para simular finalizaci√≥n -->
    <div class="text-center">
      <button id="simulateWinBtn" class="btn btn-success btn-lg">
        üéØ Simular Victoria (Ver Resultados)
      </button>
    </div>
  </main>

  <!-- Modal para cambiar nombre -->
  <div class="modal fade" id="changeNameModal" tabindex="-1" aria-labelledby="changeNameModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background: #121a2b; border: 1px solid #223150;">
        <div class="modal-header border-bottom border-secondary-subtle">
          <h5 class="modal-title text-white" id="changeNameModalLabel">Cambiar nombre</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="changeNameForm">
            <div class="mb-3">
              <label for="newPlayerName" class="form-label text-white">Ingresa tu nombre:</label>
              <input 
                type="text" 
                class="form-control" 
                id="newPlayerName" 
                placeholder="Ej: MatiasV"
                maxlength="20"
                required
                style="background: #1b2742; border: 1px solid #3d4956; color: #ffffff;"
              >
              <div class="form-text text-muted">M√°ximo 20 caracteres</div>
            </div>
          </form>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="acceptNameChange">Aceptar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Minijuego de Matem√°ticas -->
  <div class="modal fade" id="mathGameModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background: #121a2b; border: 1px solid #223150; position: relative;">
        <div class="countdown" id="mathCountdown">60s</div>
        <div class="modal-header border-bottom border-secondary-subtle">
          <h5 class="modal-title text-white">üßÆ Minijuego: Matem√°ticas</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="math-problem" id="mathProblem">
            23 + 45 + 67 = ?
          </div>
          <div class="mb-3">
            <label for="mathAnswer" class="form-label text-white">Tu respuesta:</label>
            <input 
              type="number" 
              class="form-control form-control-lg text-center" 
              id="mathAnswer"
              placeholder="Ingresa el resultado"
              style="background: #1b2742; border: 1px solid #3d4956; color: #ffffff; font-size: 1.5rem;"
            >
          </div>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="submitMathAnswer">Enviar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Minijuego de Memoria -->
  <div class="modal fade" id="memoryGameModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content" style="background: #121a2b; border: 1px solid #223150; position: relative;">
        <div class="countdown" id="memoryCountdown">60s</div>
        <div class="modal-header border-bottom border-secondary-subtle">
          <h5 class="modal-title text-white">üß† Minijuego: Memoria</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <!-- Fase 1: Mostrar secuencia -->
          <div id="memorySequencePhase">
            <p class="text-center text-white mb-3">Memoriza la siguiente secuencia:</p>
            <div class="sequence-number" id="sequenceDisplay">5</div>
            <div class="text-center">
              <small class="text-muted">N√∫mero <span id="sequencePosition">1</span> de 5</small>
            </div>
          </div>
          
          <!-- Fase 2: Pregunta -->
          <div id="memoryQuestionPhase" style="display:none;">
            <div class="alert alert-info">
              <strong>Secuencia mostrada:</strong> 5, 12, 8, 15, 3
            </div>
            <h6 class="text-white mb-3">¬øHab√≠a exactamente 2 n√∫meros pares?</h6>
            <div class="d-grid gap-2">
              <button type="button" class="btn btn-success btn-lg" id="memoryYes">‚úÖ S√≠</button>
              <button type="button" class="btn btn-danger btn-lg" id="memoryNo">‚ùå No</button>
            </div>
          </div>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Minijuego de L√≥gica -->
  <div class="modal fade" id="logicGameModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background: #121a2b; border: 1px solid #223150; position: relative;">
        <div class="countdown" id="logicCountdown">60s</div>
        <div class="modal-header border-bottom border-secondary-subtle">
          <h5 class="modal-title text-white">üß© Minijuego: L√≥gica</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="logic-statement">
            <h6 class="text-white mb-3">N√∫meros: 24, 47, 68</h6>
            <p class="text-white mb-0">Proposici√≥n: "Exactamente 2 n√∫meros son pares"</p>
          </div>
          <h6 class="text-white mt-4 mb-3">¬øEsta proposici√≥n es verdadera o falsa?</h6>
          <div class="d-grid gap-2">
            <button type="button" class="btn btn-success btn-lg" id="logicTrue">‚úÖ Verdadero</button>
            <button type="button" class="btn btn-danger btn-lg" id="logicFalse">‚ùå Falso</button>
          </div>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Resultados Finales -->
  <div class="modal fade" id="resultsModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content" style="background: #121a2b; border: 1px solid #223150;">
        <div class="modal-header border-bottom border-secondary-subtle">
          <h5 class="modal-title text-white">üéâ ¬°Partida Completada!</h5>
        </div>
        <div class="modal-body">
          <div class="text-center mb-4">
            <h4 class="text-success">¬°Victoria Cooperativa!</h4>
            <p class="text-muted">Todos los recursos han sido recolectados</p>
            <p class="text-white"><strong>Tiempo total:</strong> 04:32</p>
          </div>
          
          <h6 class="text-white mb-3">Contribuciones por jugador:</h6>
          <div class="table-responsive">
            <table class="table table-dark table-striped">
              <thead>
                <tr>
                  <th>Jugador</th>
                  <th>ü™µ Madera</th>
                  <th>ü™® Piedra</th>
                  <th>üçé Comida</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>MatiasV</strong></td>
                  <td>7</td>
                  <td>5</td>
                  <td>3</td>
                  <td><strong>15</strong></td>
                </tr>
                <tr>
                  <td>Ana</td>
                  <td>0</td>
                  <td>4</td>
                  <td>7</td>
                  <td>11</td>
                </tr>
                <tr>
                  <td>Carlos</td>
                  <td>3</td>
                  <td>1</td>
                  <td>0</td>
                  <td>4</td>
                </tr>
                <tr class="table-warning">
                  <td><strong>TOTALES</strong></td>
                  <td><strong>10</strong></td>
                  <td><strong>10</strong></td>
                  <td><strong>10</strong></td>
                  <td><strong>30</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer border-top border-secondary-subtle">
          <button type="button" class="btn btn-success btn-lg" id="newGameBtn">üîÑ Nueva Partida</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap 5 JS Bundle (CDN) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <!-- JavaScript personalizado -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Variables globales
      let resourceChart;
      let gameVersion = 'v2';
      let countdownTimers = {};
      
      // Datos simulados
      const gameData = {
        wood: { current: 7, target: 10 },
        stone: { current: 9, target: 10 },
        food: { current: 10, target: 10 }
      };

      // Referencias a elementos
      const changeNameBtn = document.getElementById('changeNameBtn');
      const changeNameModal = new bootstrap.Modal(document.getElementById('changeNameModal'));
      const newPlayerNameInput = document.getElementById('newPlayerName');
      const acceptNameChangeBtn = document.getElementById('acceptNameChange');
      const playerNameDisplay = document.getElementById('playerNameDisplay');

      // Referencias a modales de minijuegos
      const mathGameModal = new bootstrap.Modal(document.getElementById('mathGameModal'));
      const memoryGameModal = new bootstrap.Modal(document.getElementById('memoryGameModal'));
      const logicGameModal = new bootstrap.Modal(document.getElementById('logicGameModal'));
      const resultsModal = new bootstrap.Modal(document.getElementById('resultsModal'));

      // Inicializar Chart.js
      function initChart() {
        const ctx = document.getElementById('resourceChart').getContext('2d');
        resourceChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['ü™µ Madera', 'ü™® Piedra', 'üçé Comida'],
            datasets: [
              {
                label: 'Recolectado',
                data: [gameData.wood.current, gameData.stone.current, gameData.food.current],
                backgroundColor: ['#0d6efd', '#ffc107', '#198754'],
                borderColor: ['#0d6efd', '#ffc107', '#198754'],
                borderWidth: 1
              },
              {
                label: 'Meta',
                data: [gameData.wood.target, gameData.stone.target, gameData.food.target],
                backgroundColor: ['#495057', '#495057', '#495057'],
                borderColor: ['#6c757d', '#6c757d', '#6c757d'],
                borderWidth: 1
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                labels: {
                  color: '#e6e8ef'
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                grid: {
                  color: '#495057'
                },
                ticks: {
                  color: '#e6e8ef'
                }
              },
              x: {
                grid: {
                  color: '#495057'
                },
                ticks: {
                  color: '#e6e8ef'
                }
              }
            }
          }
        });
      }

      // Actualizar gr√°fico
      function updateChart() {
        if (resourceChart) {
          resourceChart.data.datasets[0].data = [
            gameData.wood.current, 
            gameData.stone.current, 
            gameData.food.current
          ];
          resourceChart.update();
        }
      }

      // Cambiar versi√≥n
      function switchVersion(version) {
        gameVersion = version;
        const versionBadge = document.getElementById('versionBadge');
        const chartContainer = document.getElementById('chartContainer');
        
        if (version === 'v1') {
          versionBadge.textContent = 'V1 (n√∫meros)';
          versionBadge.className = 'badge rounded-pill text-bg-secondary';
          chartContainer.style.display = 'none';
          
          // Cambiar textos y botones
          document.getElementById('woodDescription').textContent = 'Suma 1 por click.';
          document.getElementById('btnWood').innerHTML = '+1 Madera';
          document.getElementById('stoneDescription').textContent = 'Suma 1 por click.';
          document.getElementById('btnStone').innerHTML = '+1 Piedra';
        } else {
          versionBadge.textContent = 'V2 (minijuegos + gr√°fico)';
          versionBadge.className = 'badge rounded-pill text-bg-success';
          chartContainer.style.display = 'block';
          
          // Cambiar textos y botones  
          document.getElementById('woodDescription').textContent = 'Resuelve sumas de 3 n√∫meros.';
          document.getElementById('btnWood').innerHTML = 'üßÆ Matem√°ticas';
          document.getElementById('stoneDescription').textContent = 'Memoriza secuencias de n√∫meros.';
          document.getElementById('btnStone').innerHTML = 'üß† Memoria';
        }
      }

      // Countdown timer
      function startCountdown(elementId, duration = 60) {
        let timeLeft = duration;
        const element = document.getElementById(elementId);
        
        countdownTimers[elementId] = setInterval(() => {
          timeLeft--;
          element.textContent = timeLeft + 's';
          
          if (timeLeft <= 0) {
            clearInterval(countdownTimers[elementId]);
            element.textContent = 'Tiempo agotado';
          }
        }, 1000);
      }

      // Limpiar countdown
      function clearCountdown(elementId) {
        if (countdownTimers[elementId]) {
          clearInterval(countdownTimers[elementId]);
          delete countdownTimers[elementId];
        }
      }

      // Event Listeners
      document.getElementById('v1Radio').addEventListener('change', () => switchVersion('v1'));
      document.getElementById('v2Radio').addEventListener('change', () => switchVersion('v2'));

      // Botones de recursos
      document.getElementById('btnWood').addEventListener('click', function() {
        if (gameVersion === 'v1') {
          // V1: Incrementar directamente
          if (gameData.wood.current < gameData.wood.target) {
            gameData.wood.current++;
            document.getElementById('woodCurrent').textContent = gameData.wood.current;
            updateChart();
            showSuccessMessage();
          }
        } else {
          // V2: Abrir minijuego
          mathGameModal.show();
          startCountdown('mathCountdown');
        }
      });

      document.getElementById('btnStone').addEventListener('click', function() {
        if (gameVersion === 'v1') {
          // V1: Incrementar directamente
          if (gameData.stone.current < gameData.stone.target) {
            gameData.stone.current++;
            document.getElementById('stoneCurrent').textContent = gameData.stone.current;
            updateChart();
            showSuccessMessage();
          }
        } else {
          // V2: Abrir minijuego
          memoryGameModal.show();
          startCountdown('memoryCountdown');
          startMemorySequence();
        }
      });

      // Funcionalidad de cambio de nombre (igual que antes)
      changeNameBtn.addEventListener('click', function() {
        newPlayerNameInput.value = '';
        changeNameModal.show();
        setTimeout(() => newPlayerNameInput.focus(), 500);
      });

      acceptNameChangeBtn.addEventListener('click', function() {
        const newName = newPlayerNameInput.value.trim();
        
        if (newName === '' || newName.length > 20) {
          newPlayerNameInput.classList.add('is-invalid');
          return;
        }

        const validNamePattern = /^[a-zA-Z0-9√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë_-]+$/;
        if (!validNamePattern.test(newName)) {
          newPlayerNameInput.classList.add('is-invalid');
          return;
        }

        playerNameDisplay.innerHTML = `Jugador: <em>${newName}</em>`;
        newPlayerNameInput.classList.remove('is-invalid');
        changeNameModal.hide();
      });

      newPlayerNameInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          acceptNameChangeBtn.click();
        }
      });

      newPlayerNameInput.addEventListener('input', function() {
        this.classList.remove('is-invalid');
      });

      // Minijuego de Matem√°ticas
      document.getElementById('submitMathAnswer').addEventListener('click', function() {
        const answer = document.getElementById('mathAnswer').value;
        const correct = 135; // 23 + 45 + 67
        
        clearCountdown('mathCountdown');
        mathGameModal.hide();
        
        if (parseInt(answer) === correct) {
          gameData.wood.current = Math.min(gameData.wood.current + 1, gameData.wood.target);
          document.getElementById('woodCurrent').textContent = gameData.wood.current;
          updateChart();
          showSuccessMessage('¬°Correcto! Has recolectado madera.');
        } else {
          showErrorMessage('Respuesta incorrecta. La suma correcta era 135.');
        }
      });

      // Minijuego de Memoria
      function startMemorySequence() {
        // Simular secuencia ya mostrada
        setTimeout(() => {
          document.getElementById('memorySequencePhase').style.display = 'none';
          document.getElementById('memoryQuestionPhase').style.display = 'block';
        }, 1000);
      }

      document.getElementById('memoryYes').addEventListener('click', function() {
        clearCountdown('memoryCountdown');
        memoryGameModal.hide();
        
        // Respuesta correcta: 5, 12, 8, 15, 3 tiene exactamente 2 pares (12, 8)
        gameData.stone.current = Math.min(gameData.stone.current + 1, gameData.stone.target);
        document.getElementById('stoneCurrent').textContent = gameData.stone.current;
        updateChart();
        showSuccessMessage('¬°Correcto! Has recolectado piedra.');
      });

      document.getElementById('memoryNo').addEventListener('click', function() {
        clearCountdown('memoryCountdown');
        memoryGameModal.hide();
        showErrorMessage('Respuesta incorrecta. Hab√≠a exactamente 2 n√∫meros pares.');
      });

      // Minijuego de L√≥gica
      document.getElementById('logicTrue').addEventListener('click', function() {
        clearCountdown('logicCountdown');
        logicGameModal.hide();
        
        // Respuesta correcta: 24 y 68 son pares, 47 es impar
        gameData.food.current = Math.min(gameData.food.current + 1, gameData.food.target);
        document.getElementById('foodCurrent').textContent = gameData.food.current;
        updateChart();
        showSuccessMessage('¬°Correcto! Has recolectado comida.');
      });

      document.getElementById('logicFalse').addEventListener('click', function() {
        clearCountdown('logicCountdown');
        logicGameModal.hide();
        showErrorMessage('Respuesta incorrecta. Exactamente 2 n√∫meros eran pares.');
      });

      // Simulador de victoria
      document.getElementById('simulateWinBtn').addEventListener('click', function() {
        resultsModal.show();
      });

      // Nueva partida
      document.getElementById('newGameBtn').addEventListener('click', function() {
        gameData.wood.current = 0;
        gameData.stone.current = 0;
        gameData.food.current = 0;
        
        document.getElementById('woodCurrent').textContent = '0';
        document.getElementById('stoneCurrent').textContent = '0';
        document.getElementById('foodCurrent').textContent = '0';
        
        document.getElementById('foodCard').classList.remove('finished');
        document.getElementById('btnFood').classList.remove('btn-success');
        document.getElementById('btnFood').classList.add('btn-success');
        document.getElementById('btnFood').disabled = false;
        document.getElementById('btnFood').innerHTML = 'üß© L√≥gica';
        document.getElementById('foodDescription').textContent = 'Eval√∫a proposiciones l√≥gicas.';
        
        updateChart();
        resultsModal.hide();
        
        showSuccessMessage('¬°Nueva partida iniciada!');
      });

      // Limpiar countdowns cuando se cierran modales
      document.getElementById('mathGameModal').addEventListener('hidden.bs.modal', () => {
        clearCountdown('mathCountdown');
      });
      document.getElementById('memoryGameModal').addEventListener('hidden.bs.modal', () => {
        clearCountdown('memoryCountdown');
      });
      document.getElementById('logicGameModal').addEventListener('hidden.bs.modal', () => {
        clearCountdown('logicCountdown');
      });

      // Funciones de mensajes
      function showSuccessMessage(text = '¬°Recurso recolectado!') {
        const banner = document.getElementById('stateBanner');
        banner.className = 'alert alert-success border-0';
        banner.innerHTML = `<strong>¬°√âxito!</strong> ${text}`;
        banner.style.display = 'block';
        setTimeout(() => banner.style.display = 'none', 3000);
      }

      function showErrorMessage(text) {
        const banner = document.getElementById('stateBanner');
        banner.className = 'alert alert-danger border-0';
        banner.innerHTML = `<strong>Error:</strong> ${text}`;
        banner.style.display = 'block';
        setTimeout(() => banner.style.display = 'none', 3000);
      }

      // Simular actualizaci√≥n autom√°tica cada 5 segundos
      setInterval(updateChart, 5000);

      // Inicializaci√≥n
      initChart();
      switchVersion('v2');
    });
  </script>

</body>
</html>
